<!doctypehtml><html lang=en><meta content='text/html; charset=UTF-8'http-equiv=Content-Type><meta content='width=device-width,initial-scale=1'name=viewport><meta content='ie=edge'http-equiv=X-UA-Compatible><meta artist=Andrew Mitchell><title>Popup #1</title><style>html{height:100%}body{min-height:100%;margin:0;padding:0}canvas{padding:0;margin:auto;display:block;position:absolute;left:0;right:0;filter:sepia(.2)}</style><body><script>class Random{constructor(e){this.useA=!1;let t=function(e){let t=parseInt(e.substr(0,8),16),o=parseInt(e.substr(8,8),16),n=parseInt(e.substr(16,8),16),a=parseInt(e.substr(24,8),16);return function(){t|=0,o|=0,n|=0,a|=0;let e=(t+o|0)+a|0;return a=a+1|0,t=o^o>>>9,o=n+(n<<3)|0,n=n<<21|n>>>11,n=n+e|0,(e>>>0)/4294967296}};this.prngA=new t(e.substr(2,32)),this.prngB=new t(e.substr(34,32));for(let e=0;e<1e6;e+=2)this.prngA(),this.prngB()}random_dec(){return this.useA=!this.useA,this.useA?this.prngA():this.prngB()}random_num(e,t){return e+(t-e)*this.random_dec()}random_int(e,t){return Math.floor(this.random_num(e,t+1))}random_bool(e){return this.random_dec()<e}random_choice(e){return e[this.random_int(0,e.length-1)]}}let hash='0xb10e2d527612073b26eecdfd717e6a320cf44b4afac2b0732d9fcbe2b7fa0cf6',tokenId=1;const random=new Random(hash);let paletteBoxes=[],party=random.random_bool(.5),colorPalette={"name": "Test","colors": ["#c8c699","#c4c292","#cbc895","#2c6d41","#2b693f","#2b6e40","#5fa595","#60a393","#8e3f1a","#8a3d19","#c22d3b","#9fb46d","#2a1616","#c08047"]};function assignColorRoles(e){let t=e.map((e=>({hex:e,hsl:hexToHSL(e)}))),o=[...t].sort(((e,t)=>t.hsl.l-e.hsl.l)),n=[...t].sort(((e,t)=>t.hsl.s-e.hsl.s));return{fillColor:hexToHSLString(o[Math.floor(o.length/2)].hex),lightColor:hexToHSLString(o[1].hex),lighterColor:hexToHSLString(o[0].hex),darkColor:hexToHSLString(o[o.length-2].hex),darkerColor:hexToHSLString(o[o.length-1].hex),accentColor:hexToHSLString(n[0].hex),textColorLight:hexToHSLString(o[0].hex),textColorDark:hexToHSLString(o[o.length-1].hex),backgroundColor:hexToHSLString(o[o.length-1].hex)}}function resetColors(e=!0){const t=assignColorRoles(colorPalette.colors);e&&(fillColor=t.fillColor),lightColor=t.lightColor,lighterColor=t.lighterColor,darkColor=t.darkColor,darkerColor=t.darkerColor,accentColor=t.accentColor,textColorLight=t.textColorLight,textColorDark=t.textColorDark,backgroundColor=t.backgroundColor}let colorRoles=assignColorRoles(colorPalette.colors),fillColor=colorRoles.fillColor,lightColor=colorRoles.lightColor,lighterColor=colorRoles.lighterColor,darkColor=colorRoles.darkColor,darkerColor=colorRoles.darkerColor,accentColor=colorRoles.accentColor,textColorLight=colorRoles.textColorLight,textColorDark=colorRoles.textColorDark,backgroundColor=colorRoles.backgroundColor;colors=sortColorsByHSL(colorPalette.colors),paletteBoxes.push({color:fillColor});for(let e=1;e<colors.length;e++)paletteBoxes.push({color:hexToHSLString(colors[e])});let boxes=[],numBoxes=2;for(let e=0;e<numBoxes;e++)boxes.push(hexToHSLString(random.random_choice(colors)));const canvas=document.createElement('canvas');let smallerDimension=Math.min(window.innerHeight,window.innerWidth);canvas.width=4e3,canvas.height=4e3;const ctx=canvas.getContext('2d');canvas.style.width=smallerDimension+'px',canvas.style.height=smallerDimension+'px',canvas.style.boxShadow='0 0 1.5rem #252525',document.body.appendChild(canvas);let lineOffsetX=.001*smallerDimension,lineOffsetY=.001*smallerDimension,bottomBarHeight=.05*canvas.height,offscreenCanvas=document.createElement('canvas'),topCanvas=document.createElement('canvas');offscreenCanvas.width=canvas.width,offscreenCanvas.height=canvas.height,topCanvas.width=canvas.width,topCanvas.height=canvas.height;let offscreenCtx=offscreenCanvas.getContext('2d'),topCtx=topCanvas.getContext('2d'),secondaryCanvas=document.createElement('canvas'),backgroundCanvas=document.createElement('canvas'),backgroundToggle={},bgColorToggle={},downloadBox={},isResidueVisible=!1,isBgColorToggle=!0,isDownloading=!1;secondaryCanvas.width=canvas.width,secondaryCanvas.height=canvas.height,backgroundCanvas.width=canvas.width,backgroundCanvas.height=canvas.height;let paletteWidth,titleOffset,secondaryCtx=secondaryCanvas.getContext('2d'),backgroundCtx=backgroundCanvas.getContext('2d');function drawBase(){isResidueVisible||(backgroundCtx.clearRect(0,0,canvas.width,canvas.height),secondaryCtx.clearRect(0,0,canvas.width,canvas.height)),fillBackground(),drawBottomBar(),drawBottomBarLines(),drawPaletteBoxes()}function fillBackground(){let e=hexToHSL(colors[0]);backgroundColor=hslToString(e.h,e.s,isBgColorToggle?e.l+.1*e.l:e.l-.1*e.l),backgroundCtx.fillStyle=backgroundColor,backgroundCtx.fillRect(0,0,canvas.width,canvas.height),backgroundCtx.fillStyle=fillColor}function drawBottomBar(){topCtx.fillStyle=fillColor,topCtx.fillRect(0,canvas.height-bottomBarHeight,canvas.width,bottomBarHeight),topCtx.strokeStyle=accentColor,topCtx.lineCap='round',topCtx.lineWidth=Math.floor(canvas.width/700)}function drawBottomBarLines(){topCtx.beginPath(),topCtx.moveTo(0,canvas.height-bottomBarHeight),topCtx.lineTo(canvas.width,canvas.height-bottomBarHeight),topCtx.stroke()}function drawCenteredText(e,t,o,n){e.font=canvas.width/75+'px Helvetica',e.fillStyle=n;const a=e.measureText(t),l=a.width,s=o.x-l-16*lineOffsetX,i=o.y+(o.height+a.actualBoundingBoxAscent)/2;e.fillText(t,s,i)}function drawPaletteBoxes(){titleOffset=.005*canvas.width,paletteWidth=(canvas.width-2*titleOffset)/colors.length;for(let e=0;e<paletteBoxes.length;e++){let t=canvas.width-(e+1)*paletteWidth-titleOffset;topCtx.fillStyle=paletteBoxes[e].color,paletteBoxes[e].x=t,paletteBoxes[e].y=canvas.height-bottomBarHeight+titleOffset,paletteBoxes[e].width=paletteWidth,paletteBoxes[e].height=bottomBarHeight-2*titleOffset,topCtx.fillRect(paletteBoxes[e].x,paletteBoxes[e].y,paletteBoxes[e].width,paletteBoxes[e].height),paletteBoxes[e].isSelected?drawBoxBorders(t+3*lineOffsetX,canvas.height-bottomBarHeight+titleOffset-2*lineOffsetY,bottomBarHeight-2*titleOffset,paletteWidth-4*lineOffsetX,topCtx):drawBoxBorders(t,canvas.height-bottomBarHeight+titleOffset,bottomBarHeight-2*titleOffset,paletteWidth,topCtx)}}boxData=[];let minWidthAll=random.random_int(100,1e3),maxWidthAll=random.random_int(1e3,canvas.width),minHeightAll=random.random_int(3,5),maxHeightAll=random.random_int(5,15);for(let e=0;e<numBoxes;e++){secondaryCtx.font=canvas.width/75+'px Helvetica';let e=random.random_int(100,maxWidthAll),t=random.random_num(minWidthAll,e)+16*lineOffsetX,o=random.random_int(5,maxHeightAll),n=random.random_num(minHeightAll,o),a=n*(canvas.width/30);n<4&&(a=n*(canvas.width/25)),boxData.push({boxWidth:t,boxHeight:a,gEnabled:e===0||random.random_bool(.3)})}function isColliding(e,t){const o=e.x+1.1*e.boxWidth,n=e.y+1.1*e.boxHeight,a=t.x+1.1*t.boxWidth,l=t.y+1.1*t.boxHeight;return!(t.x>=o||e.x>=a||t.y>=n||e.y>=l)}function positionBox(e,t){let o=0;do{if(e.x=random.random_num(10,canvas.width-e.boxWidth-canvas.width*.04),e.y=random.random_num(10,canvas.height-bottomBarHeight-e.boxHeight),!t.some((t=>isColliding(e,t))))return!0;o++}while(o<50);return!1}for(let e=0;e<boxData.length;e++)positionBox(boxData[e],boxData.slice(0,e))||(boxData.splice(e,1),e--);function drawBoxBorders(e,t,o,n,a=null){(a=a||offscreenCtx).strokeStyle=lightColor,a.lineWidth=Math.floor(canvas.width/1e3),a.beginPath(),a.moveTo(e,t+o),a.lineTo(e,t),a.lineTo(e+n,t),a.stroke(),a.strokeStyle=lighterColor,a.beginPath(),a.moveTo(e+lineOffsetX,t+o),a.lineTo(e+lineOffsetX,t+lineOffsetY),a.lineTo(e+n,t+lineOffsetY),a.stroke(),a.strokeStyle=darkerColor,a.beginPath(),a.moveTo(e,t+o+lineOffsetY),a.lineTo(e+n,t+o+lineOffsetY),a.lineTo(e+n,t),a.stroke(),a.strokeStyle=darkColor,a.beginPath(),a.moveTo(e,t+o),a.lineTo(e-lineOffsetX+n,t+o),a.lineTo(e-lineOffsetX+n,t),a.stroke()}function drawBoxBorders2(e,t,o,n,a=null){(a=a||offscreenCtx).strokeStyle=darkColor,a.lineWidth=Math.floor(canvas.width/1e3),a.beginPath(),a.moveTo(e,t+o),a.lineTo(e,t),a.lineTo(e+n,t),a.stroke(),a.strokeStyle=darkColor,a.beginPath(),a.moveTo(e+lineOffsetX,t+o),a.lineTo(e+lineOffsetX,t+lineOffsetY),a.lineTo(e+n,t+lineOffsetY),a.stroke(),a.strokeStyle=lightColor,a.beginPath(),a.moveTo(e,t+o+lineOffsetY),a.lineTo(e+n,t+o+lineOffsetY),a.lineTo(e+n,t),a.stroke(),a.strokeStyle=lightColor,a.beginPath(),a.moveTo(e,t+o),a.lineTo(e-lineOffsetX+n,t+o),a.lineTo(e-lineOffsetX+n,t),a.stroke()}function drawBoxes(){let e=35,t=0;for(let o of boxData){t++,e+=4;let n=o.x,a=o.y,l=o.boxWidth,s=o.boxHeight;offscreenCtx.fillStyle=party?boxes[t]:fillColor,offscreenCtx.fillRect(n,a,l,s),offscreenCtx.fillRect(n,a,l,s);let i=offscreenCtx.createLinearGradient(n+25*lineOffsetX,a+25*lineOffsetY,n+l-50*lineOffsetX,a+25*lineOffsetY);i.addColorStop(0,accentColor),i.addColorStop(1,lighterColor),offscreenCtx.fillStyle=i,offscreenCtx.beginPath(),offscreenCtx.fillRect(n+25*lineOffsetX,a+25*lineOffsetY,l-50*lineOffsetX,canvas.width/40),offscreenCtx.stroke(),offscreenCtx.fillStyle=party?boxes[t]:fillColor,drawBoxBorders(n,a,s,l),drawBoxBorders2(n+50*lineOffsetX,a+100*lineOffsetY+canvas.width/40,s-100*lineOffsetY-(50*lineOffsetY+canvas.width/40),l-100*lineOffsetX)}secondaryCtx.drawImage(offscreenCanvas,0,0)}function posterizeCanvas(e,t,o){for(var n=e.getImageData(0,0,t.width,t.height),a=n.data,l=Math.ceil(255/o),s=0;s<a.length;s+=4)for(var i=0;i<3;i++)a[s+i]=Math.floor(a[s+i]/l)*l;e.putImageData(n,0,0)}let first=!0,first2=!0;function redrawCanvas(){if(offscreenCtx.clearRect(0,0,offscreenCanvas.width,offscreenCanvas.height),topCtx.clearRect(0,0,offscreenCanvas.width,offscreenCanvas.height),drawBase(),drawBoxes(),isDownloading&&(download(),isDownloading=!1),ctx.drawImage(backgroundCanvas,0,0,canvas.width,canvas.height),ctx.drawImage(secondaryCanvas,0,0,canvas.width,canvas.height),ctx.drawImage(topCanvas,0,0,canvas.width,canvas.height),first){first2&&(first2=!1,backgroundToggle.isSelected=!0,isResidueVisible=!isResidueVisible,secondaryCtx.clearRect(0,0,canvas.width,canvas.height+bottomBarHeight),redrawCanvas()),first=!1;const e=canvas.width/random.random_num(1.5,3),t=canvas.height/random.random_num(1.5,3);let o=e,n=t,a=setInterval((function(){gravitate(o,n)}),80);setTimeout((()=>{clearInterval(a),a=null,redrawCanvas()}),800),addMouseEvents()}}function download(){var e=document.createElement('canvas');e.width=canvas.width-bottomBarHeight,e.height=canvas.height-bottomBarHeight;var t=e.getContext('2d');t.filter='sepia(.2)',t.drawImage(backgroundCanvas,0,0,e.width,backgroundCanvas.height),t.drawImage(secondaryCanvas,0,0,e.width,secondaryCanvas.height);var o=document.createElement('a');o.download='Palette_#1.png',o.href=e.toDataURL(),o.click()}const contextMenu=document.createElement('div');function createMenuItem(e){const t=document.createElement('div');return t.textContent=e,t.style.padding='.5em',t.style.cursor='pointer',t.style.color='#fff',t.style.fontFamily='Helvetica',t.style.fontSize='16px',t.style.minHeight='44px',t.style.display='flex',t.style.alignItems='center',t.addEventListener('mouseover',(()=>{t.style.backgroundColor='#fff',t.style.color='#000'})),t.addEventListener('mouseout',(()=>{t.style.backgroundColor='transparent',t.style.color='#fff'})),t}contextMenu.style.position='fixed',contextMenu.style.display='none',contextMenu.style.backgroundColor='#000',contextMenu.style.border='.01em solid #fff',contextMenu.style.padding='.1em',contextMenu.style.zIndex='1000',contextMenu.style.minWidth='150px',contextMenu.style.touchAction='none';const copyOption=createMenuItem('Copy Image');copyOption.addEventListener('click',(e=>{const t=document.createElement('canvas');t.width=canvas.width-bottomBarHeight,t.height=canvas.height-bottomBarHeight;const o=t.getContext('2d');backgroundCtx.filter='sepia(.2)',secondaryCtx.filter='sepia(.2)',o.filter='sepia(.2)',o.drawImage(backgroundCanvas,0,0,t.width,backgroundCanvas.height),o.drawImage(secondaryCanvas,0,0,t.width,secondaryCanvas.height),t.toBlob((e=>{const t=new ClipboardItem({'image/png':e});navigator.clipboard.write([t])})),contextMenu.style.display='none'}));const bgOption=createMenuItem('Toggle Background');bgOption.addEventListener('click',(e=>{isBgColorToggle=!isBgColorToggle,backgroundCtx.clearRect(0,0,canvas.width,canvas.height),redrawCanvas(),contextMenu.style.display='none'}));const residueOption=createMenuItem('Toggle Residue');residueOption.addEventListener('click',(e=>{isResidueVisible=!isResidueVisible,secondaryCtx.clearRect(0,0,canvas.width,canvas.height+bottomBarHeight),redrawCanvas(),contextMenu.style.display='none'}));const downloadOption=createMenuItem('Download PNG');downloadOption.addEventListener('click',(e=>{isDownloading=!0,redrawCanvas(),contextMenu.style.display='none'})),contextMenu.appendChild(copyOption),contextMenu.appendChild(bgOption),contextMenu.appendChild(residueOption),contextMenu.appendChild(downloadOption),document.body.appendChild(contextMenu);function showContextMenu(e,t){contextMenu.style.display='block';const o=contextMenu.getBoundingClientRect(),n=window.innerWidth,a=window.innerHeight;e+o.width>n&&(e=n-o.width),t+o.height>a&&(t=a-o.height),contextMenu.style.left=e+'px',contextMenu.style.top=t+'px'}canvas.addEventListener('contextmenu',(e=>{e.preventDefault(),showContextMenu(e.pageX,e.pageY)})),document.addEventListener('click',(e=>{contextMenu.contains(e.target)||(contextMenu.style.display='none')})),redrawCanvas();let offsetX,offsetY,gravitateInterval=null,gX=0,gY=0,isDragging=!1,selectedBox=null,selectedPaletteBox=null;function addMouseEvents(){canvas.addEventListener('mousedown',(e=>{if(0===e.button){const t=canvas.getBoundingClientRect();let o=e.clientX-t.left,n=e.clientY-t.top;o=mapValue(o,0,smallerDimension,0,canvas.width),n=mapValue(n,0,smallerDimension,0,canvas.height);for(let e of boxData)if(o>=e.x&&o<=e.x+e.boxWidth&&n>=e.y&&n<=e.y+e.boxHeight){isDragging=!0,selectedBox=e,offsetX=o-e.x,offsetY=n-e.y;break}if(null!=selectedBox)return;for(let e=0;e<paletteBoxes.length;e++){const t=paletteBoxes[e];if(o>=t.x&&o<=t.x+t.width&&n>=t.y&&n<=t.y+t.height)return selectedPaletteBox=t,selectedPaletteBox.isSelected=!0,fillColor=selectedPaletteBox.color,party=!1,resetColors(!1),void redrawCanvas()}null==gravitateInterval&&(gX=o,gY=n,gravitateInterval=setInterval((function(){gravitate(gX,gY)}),10))}}))}function gravitate(e,t){for(let o of boxData){if(o.gEnabled){const n=e-(o.x+o.boxWidth/2),a=t-(o.y+o.boxHeight/2),l=Math.sqrt(n*n+a*a),s=n/l,i=a/l,r=2;o.x+=s*r,o.y+=i*r}}redrawCanvas()}canvas.addEventListener('mousemove',(e=>{if(isDragging&&selectedBox){const t=canvas.getBoundingClientRect();let o=e.clientX-t.left,n=e.clientY-t.top;o=mapValue(o,0,smallerDimension,0,canvas.width),n=mapValue(n,0,smallerDimension,0,canvas.height),selectedBox.x=o-offsetX,selectedBox.y=n-offsetY,redrawCanvas()}if(null!=gravitateInterval){const t=canvas.getBoundingClientRect();let o=e.clientX-t.left,n=e.clientY-t.top;gX=mapValue(o,0,smallerDimension,0,canvas.width),gY=mapValue(n,0,smallerDimension,0,canvas.height)}})),canvas.addEventListener('mouseup',(e=>{if(clearInterval(gravitateInterval),gravitateInterval=null,isDragging=!1,null!=selectedPaletteBox&&(selectedPaletteBox.isSelected=!1,party=!1,selectedPaletteBox=null,redrawCanvas()),null==selectedBox)return;const t=canvas.getBoundingClientRect();let o=e.clientX-t.left,n=e.clientY-t.top;o=mapValue(o,0,smallerDimension,0,canvas.width),n=mapValue(n,0,smallerDimension,0,canvas.height),selectedBox.x=o-offsetX,selectedBox.y=n-offsetY,selectedBox=null,redrawCanvas()})),canvas.addEventListener('contextmenu',(function(e){}));let lastTapTime=0;function hexToHSLString(e){const t=hexToHSL(e);return hslToString(t.h,t.s,t.l)}function hslToString(e,t,o){return`hsl(${e}, ${t}%, ${o}%)`}function hexToHSL(e){e=e.replace(/^#/,'');let t,o,n=parseInt(e.substring(0,2),16)/255,a=parseInt(e.substring(2,4),16)/255,l=parseInt(e.substring(4,6),16)/255,s=Math.max(n,a,l),i=Math.min(n,a,l),r=(s+i)/2;if(s===i)t=o=0;else{let e=s-i;switch(o=r>.5?e/(2-s-i):e/(s+i),s){case n:t=(a-l)/e+(a<l?6:0);break;case a:t=(l-n)/e+2;break;case l:t=(n-a)/e+4}t/=6}return t=Math.round(360*t),o=Math.round(100*o),r=Math.round(100*r),{h:t,s:o,l:r}}function sortColorsByHSL(e){return[...e].sort(((e,t)=>{const o=hexToHSL(e),n=hexToHSL(t);return o.h!==n.h?o.h-n.h:o.s!==n.s?n.s-o.s:n.l-o.l}))}function mapValue(e,t,o,n,a){return n+(e-t)/(o-t)*(a-n)}canvas.addEventListener('touchstart',(e=>{e.preventDefault(),contextMenu.contains(e.target)||(contextMenu.style.display='none');const t=(new Date).getTime();lastTapTime=t;const o=canvas.getBoundingClientRect();let n=e.touches[0].clientX-o.left,a=e.touches[0].clientY-o.top;n=mapValue(n,0,smallerDimension,0,canvas.width),a=mapValue(a,0,smallerDimension,0,canvas.height);for(let e of boxData)if(n>=e.x&&n<=e.x+e.boxWidth&&a>=e.y&&a<=e.y+e.boxHeight){isDragging=!0,selectedBox=e,offsetX=n-e.x,offsetY=a-e.y;lastTapTime=0;break}if(null==selectedBox){for(let e=0;e<paletteBoxes.length;e++){const t=paletteBoxes[e];if(n>=t.x&&n<=t.x+t.width&&a>=t.y&&a<=t.y+t.height)return selectedPaletteBox=t,selectedPaletteBox.isSelected=!0,fillColor=selectedPaletteBox.color,resetColors(!1),party=false,void redrawCanvas();}null==gravitateInterval&&(gX=n,gY=a,gravitateInterval=setInterval((function(){gravitate(gX,gY)}),10))}})),canvas.addEventListener('touchmove',(e=>{if(e.preventDefault(),isDragging&&selectedBox){const t=canvas.getBoundingClientRect();let o=e.touches[0].clientX-t.left,n=e.touches[0].clientY-t.top;o=mapValue(o,0,smallerDimension,0,canvas.width),n=mapValue(n,0,smallerDimension,0,canvas.height),selectedBox.x=o-offsetX,selectedBox.y=n-offsetY,redrawCanvas()}if(null!=gravitateInterval){const t=canvas.getBoundingClientRect();let o=e.touches[0].clientX-t.left,n=e.touches[0].clientY-t.top;gX=mapValue(o,0,smallerDimension,0,canvas.width),gY=mapValue(n,0,smallerDimension,0,canvas.height)}})),canvas.addEventListener('touchend',(e=>{e.preventDefault();const t=(new Date).getTime()-lastTapTime;if(t<1500&&t>500&&t>0)return clearInterval(gravitateInterval),gravitateInterval=null,br=canvas.getBoundingClientRect(),showContextMenu(br.left,br.top),void(lastTapTime=0);clearInterval(gravitateInterval),gravitateInterval=null,backgroundToggle.isSelected&&(backgroundToggle.isSelected=!1,redrawCanvas()),bgColorToggle.isSelected&&(bgColorToggle.isSelected=!1,redrawCanvas()),downloadBox.isSelected&&(downloadBox.isSelected=!1,isDownloading=!0,redrawCanvas()),null!=selectedPaletteBox&&(selectedPaletteBox.isSelected=!1,selectedPaletteBox=null,redrawCanvas()),isDragging=!1,selectedBox=null,redrawCanvas()}))</script></body></html>